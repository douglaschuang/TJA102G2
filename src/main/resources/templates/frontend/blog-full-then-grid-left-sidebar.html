<!DOCTYPE html>
<html class="no-js" lang="zh-Hant" xmlns:th="http://www.thymeleaf.org">

<head
	th:replace="~{frontend/layout :: head('BabyMate', ~{::extraHead})}">
<th:block th:fragment="extraHead"></th:block>
</head>

<body
	th:replace="~{frontend/layout :: layout('about', ~{::content}, ~{::extraJs}, 'footer-one')}">
	<section th:fragment="content">
		<div
			th:replace="~{frontend/fragments/breadcrumb :: breadcrumb('會員儀表板')}"></div>



		<!-- page wrapper! -->
		<div class="blog-page-wrapper mb-100">
			<div class="container">
				<div class="row">
					<!-- sidebar -->
					<div class="col-lg-3 order-2 order-lg-1">
						<div class="page-sidebar">
							<div class="single-sidebar-widget mb-40">
								<div class="search-widget">
									<!-- <form action="#" th:action="@{/}">
										<input type="search" placeholder="搜尋您的育兒與生活紀錄">
										<button type="button">
											<i class="ion-android-search"></i>
										</button>
									</form> -->
									<form th:action="@{/blog/full-grid-left}" method="get">
										<input type="hidden" name="tab" value="search"> <input
											type="search" name="q" th:value="${param.q}"
											placeholder="搜尋您的育兒與生活紀錄">
										<button type="submit">
											<i class="ion-android-search"></i>
										</button>
									</form>

								</div>
							</div>

							<div class="single-sidebar-widget mb-40">
								<h2 class="single-sidebar-widget--title">育兒與生活</h2>
								<ul
									class="single-sidebar-widget--list single-sidebar-widget--list--category">
									<li class="has-children"><a
										th:href="@{/blog/full-grid-left(tab='mhb')}">媽媽手冊</a>
										<ul>
											<li><a
												th:href="@{/blog/full-grid-left(tab='mhb-records', mhbId=${mhb?.motherHandbookId})}">媽媽懷孕紀錄</a></li>
											<li><a
												th:href="@{/blog/full-grid-left(tab='mhb-charts', mhbId=${mhb?.motherHandbookId})}">身體指數紀錄圖表</a></li>
											<li><a th:href="@{/blog/full-grid-left(tab='todos')}">待辦事項</a></li>
										</ul></li>

									<li class="has-children"><a
										th:href="@{/blog/full-grid-left-bb(tab='babyhandbook')}">寶寶手冊</a>
										<ul>
											<li><a
												th:href="@{/u/baby/babyrecord/full-grid-left-br(tab='babyrecord', babyhandbookid=${babyhandbook?.babyhandbookid})}">寶寶成長紀錄</a></li>
											<li><a
												th:href="@{/u/baby/baby-chart/full-grid-left-ch(tab='babychart', babyhandbookid=${babyhandbook?.babyhandbookid})}">寶寶生長曲線圖</a></li>
											<!-- <li><a th:href="@{/u/baby/baby-todo/full-grid-left-td(tab='todo')}">待辦事項</a></li> -->

										</ul></li>
									<li><a th:href="@{/blog/full-grid-left(tab='calendar')}">我的日曆</a></li>
									<li><a th:href="@{/blog/full-grid-left(tab='album')}">我的相簿</a></li>
									<li><a th:href="@{/blog/full-grid-left(tab='diary')}">我的日記</a></li>
									<li><a href="/sleep/quiz" th:href="@{/sleep/quiz}">睡眠健康測驗</a></li>
									<!-- <li><a th:href="@{/blog/full-grid-left(tab='notice')}">通知</a></li> -->
								</ul>
							</div>

							<div class="single-sidebar-widget mb-40">
								<h2 class="single-sidebar-widget--title">最新日記</h2>

								<!-- 空狀態（未登入或沒有文章） -->
								<div th:if="${#lists.isEmpty(latestDiary)}"
									class="text-muted small">
									<span th:if="${session.member == null}"> 請先<a
										th:href="@{/shop/login}">登入</a>，登入後會顯示你的最新日記。
									</span> <span th:if="${session.member != null}"> 還沒有日記～<a
										th:href="@{/u/diary/new}">寫第一篇</a>！
									</span>
								</div>

								<div class="widget-post-wrapper"
									th:if="${!#lists.isEmpty(latestDiary)}">
									<div class="single-widget-post d-flex gap-2 align-items-start"
										th:each="d : ${latestDiary}">
										<!-- 縮圖 -->
										<a th:if="${d.hasImage()}" th:href="@{'/u/diary/' + ${d.id}}">
											<img th:src="@{'/u/diary/' + ${d.id} + '/image'}"
											alt="diary cover"
											style="width: 72px; height: 72px; object-fit: cover; border-radius: 6px;">
										</a>

										<div class="content">
											<h3 class="widget-post-title">
												<a th:href="@{'/u/diary/' + ${d.id}}"
													th:text="${d.title != null ? d.title : '（無標題）'}">日記標題</a>
											</h3>
											<p class="widget-post-date"
												th:text="${#temporals.format(d.writtenAt != null ? d.writtenAt : d.createdAt, 'yyyy-MM-dd')}">2025-01-01</p>
											<!-- <p class="small text-muted"
												th:text="${#strings.abbreviate(d.content, 60)}">內容摘要</p> -->
										</div>
									</div>
									<div class="mt-2">
										<a class="btn btn-xs btn-outline-secondary"
											th:href="@{/blog/full-grid-left(tab='diary')}">更多日記</a>
									</div>
								</div>

							</div>


						</div>
					</div>

					<!-- main -->
					<div class="col-lg-9 order-1 order-lg-2 mb-md-70 mb-sm-70"
						th:with="activeTab=${tab != null ? tab : (param.tab != null ? param.tab[0] : null)}"
						th:switch="${activeTab}">
						
						<!-- 搜尋結果（最小可視化 + debug 計數） -->
<div th:case="'search'">
  <h4 class="mb-2">搜尋結果：<span th:text="${q}">kw</span></h4>

  <div th:if="${needLogin}" class="alert alert-info">
    請先<a th:href="@{/shop/login}">登入</a>，才能搜尋你的內容。
  </div>

  <div th:if="${!needLogin}">
    <p class="text-muted small">
      查詢結果 → 日記: <span th:text="${diaries != null ? diaries.size() : 0}">0</span>、
      相簿: <span th:text="${photos  != null ? photos.size()  : 0}">0</span>、
      代辦清單:  <span th:text="${todos   != null ? todos.size()   : 0}">0</span>
    </p>

    <!-- 日記 -->
    <div class="mb-3">
      <div class="d-flex justify-content-between align-items-center">
        <h6 class="mb-2">日記</h6>
        <a class="btn btn-sm btn-outline-secondary"
           th:href="@{/blog/full-grid-left(tab='diary', q=${q})}">更多</a>
      </div>
      <div th:if="${diaries == null or #lists.isEmpty(diaries)}" class="text-muted small">沒有符合的日記</div>
      <div class="list-group" th:if="${diaries != null and !#lists.isEmpty(diaries)}">
        <a class="list-group-item list-group-item-action" th:each="e : ${diaries}" th:href="@{'/u/diary/' + ${e.id}}">
          <div class="d-flex w-100 justify-content-between">
            <!-- <strong th:text="${e.title ?: '（無標題）'}">標題</strong> -->
            <strong th:text="${e.title != null ? e.title : '（無標題）'}">標題</strong>
            
            <small class="text-muted"
              th:text="${#temporals.format(e.writtenAt != null ? e.writtenAt : e.createdAt, 'yyyy-MM-dd HH:mm')}">日期</small>
          </div>
          <div class="text-muted" th:text="${#strings.abbreviate(e.content, 80)}">摘要</div>
        </a>
      </div>
    </div>

    <!-- 相簿 -->
    <div class="mb-3">
      <div class="d-flex justify-content-between align-items-center">
        <h6 class="mb-2">相簿</h6>
        <a class="btn btn-sm btn-outline-secondary"
           th:href="@{/blog/full-grid-left(tab='album', q=${q})}">更多</a>
      </div>
      <div th:if="${photos == null or #lists.isEmpty(photos)}" class="text-muted small">沒有符合的照片</div>
      <div class="row row-cols-2 row-cols-md-3 row-cols-lg-4 g-3"
           th:if="${photos != null and !#lists.isEmpty(photos)}">
        <div class="col" th:each="p : ${photos}">
          <a th:href="@{'/album/photo/' + ${p.id}}" target="_blank">
            <img class="img-fluid rounded" th:src="@{'/album/photo/' + ${p.id}}" alt="photo">
          </a>
        </div>
      </div>
    </div>

    <!-- 待辦 -->
    <div class="mb-3">
      <div class="d-flex justify-content-between align-items-center">
        <h6 class="mb-2">待辦事項</h6>
        <a class="btn btn-sm btn-outline-secondary"
           th:href="@{/blog/full-grid-left(tab='todos')}">前往待辦</a>
      </div>
      <div th:if="${todos == null or #lists.isEmpty(todos)}" class="text-muted small">沒有符合的待辦</div>
      <ul class="list-group" th:if="${todos != null and !#lists.isEmpty(todos)}">
        <!-- <li class="list-group-item d-flex justify-content-between align-items-center" th:each="t : ${todos}">
          <span>
            <span th:text="${t.title}">標題</span>
            <small class="text-muted ms-2" th:if="${t.note != null}" th:text="${#strings.abbreviate(t.note, 60)}">備註</small>
          </span>
          <span class="badge text-bg-light" th:text="${t.status}">狀態</span>
        </li> -->
        <li class="list-group-item d-flex justify-content-between align-items-center" th:each="t : ${todos}">
  <span>
    <span th:text="${t.title != null ? t.title : '（無標題）'}">標題</span>
    <small class="text-muted ms-2"
           th:if="${t.note != null}"
           th:text="${#strings.abbreviate(t.note, 60)}">備註</small>
  </span>
  <span class="badge text-bg-light"
        th:text="${(t.done != null and t.done) ? '已完成' : '未完成'}">狀態</span>
</li>
        
      </ul>
    </div>
  </div>
</div>
						

						<!-- 媽媽手冊 -->
						<div th:case="'mhb'">
							<div
								th:replace="~{fragments/mhb-tabs :: mhbTabs(${activeTab}, ${mhb})}"></div>
							<div th:if="${mhb == null}" class="alert alert-info">
								目前尚未建立媽媽手冊。<a class="btn btn-primary btn-sm ms-2"
									th:href="@{/u/mhb/new}">建立媽媽手冊</a>
							</div>

							<div th:if="${mhb != null}">
								<div
									th:replace="~{fragments/mhb-detail :: mhbDetail(${mhb}, ${pregnancyWeek})}"></div>
							</div>
						</div>

						<!-- 媽媽懷孕紀錄 -->
						<div th:case="'mhb-records'">
							<div
								th:replace="~{fragments/mhb-tabs :: mhbTabs(${activeTab}, ${mhb})}"></div>
							<div
								th:replace="~{fragments/mhb-records :: mhbRecords(${mhb}, ${records}, ${pregnancyWeek})}"></div>
						</div>

						<!-- 身體指數紀錄圖表 -->
						<div th:case="'mhb-charts'">
							<div
								th:replace="~{fragments/mhb-tabs :: mhbTabs(${activeTab}, ${mhb})}"></div>
							<div
								th:replace="~{fragments/mhb-charts :: mhbCharts(${mhb}, ${chartLabels}, ${chartWeights}, ${chartSp}, ${chartDp}, ${chartFhs})}"></div>
						</div>

						<!-- 待辦事項 -->
						<div th:case="'todos'">
							<div
								th:replace="~{fragments/mhb-tabs :: mhbTabs(${activeTab}, ${mhb})}"></div>
							<div
								th:replace="~{fragments/mhb-todos :: mhbTodos(${mhb}, ${todos})}"></div>
						</div>

						<!-- 我的相簿 -->
						<div th:case="'album'">
							<div
								class="d-flex justify-content-between align-items-center mb-3">
								<h4 class="mb-0">我的相簿</h4>
								<a class="btn btn-primary btn-sm" th:href="@{/u/album/new}">上傳照片</a>
							</div>

							<!-- 空狀態 -->
							<div th:if="${photos == null or #lists.isEmpty(photos)}"
								class="alert alert-info">
								目前還沒有照片～<a class="btn btn-primary btn-sm ms-2"
									th:href="@{/u/album/new}">立即上傳</a>
							</div>

							<!-- 照片格狀牆 -->
							<div class="row row-cols-2 row-cols-md-3 row-cols-lg-4 g-3"
								th:if="${photos != null and !#lists.isEmpty(photos)}">
								<div class="col" th:each="p : ${photos}">
									<div class="card h-100 shadow-sm">
										<a th:href="@{'/album/photo/' + ${p.id}}" target="_blank">
											<img class="card-img-top"
											th:src="@{'/album/photo/' + ${p.id}}" alt="photo">
										</a>
										<div class="card-body py-2">
											<div class="small text-muted"
												th:text="${#temporals.format(p.takenAt != null ? p.takenAt : p.createdAt, 'yyyy-MM-dd')}">
												2025-01-01</div>
											<div class="small text-truncate" th:text="${p.caption}">說明</div>
										</div>
										<div class="card-footer bg-transparent border-0 pt-0">
											<form th:action="@{'/u/album/' + ${p.id} + '/delete'}"
												method="post" class="d-inline">
												<input type="hidden" th:name="${_csrf?.parameterName}"
													th:value="${_csrf?.token}">
												<button class="btn btn-sm btn-outline-danger"
													onclick="return confirm('確定刪除這張照片？')">刪除</button>
											</form>
										</div>
									</div>
								</div>
							</div>
						</div>


						<!-- 我的日記 -->
						<div th:case="'diary'">
							<div
								class="d-flex justify-content-between align-items-center mb-3">
								<h4 class="mb-0">我的日記</h4>
								<a class="btn btn-primary btn-sm" th:href="@{/u/diary/new}">新增日記</a>
							</div>

							<!-- 空狀態 -->
							<div th:if="${entries == null or #lists.isEmpty(entries)}"
								class="alert alert-info">
								還沒有日記～<a class="btn btn-primary btn-sm ms-2"
									th:href="@{/u/diary/new}">寫第一篇</a>
							</div>

							<!-- 日記清單（有資料時） -->
							<div class="list-group"
								th:if="${entries != null and !#lists.isEmpty(entries)}">
								<div class="list-group-item py-3" th:each="e : ${entries}">
									<div
										class="d-flex w-100 justify-content-between align-items-start gap-3">
										<a th:if="${e.hasImage()}" th:href="@{'/u/diary/' + ${e.id}}">
											<img th:src="@{'/u/diary/' + ${e.id} + '/image'}" alt="cover"
											style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px;">
										</a>
										<div class="flex-fill">
											<div class="d-flex w-100 justify-content-between">
												<h6 class="mb-1"
													th:text="${e.title != null ? e.title : '（無標題）'}">日記標題</h6>
												<small class="text-muted"
													th:text="${#temporals.format(e.writtenAt != null ? e.writtenAt : e.createdAt, 'yyyy-MM-dd HH:mm')}">2025-01-01</small>
											</div>
											<!-- <p class="mb-2 text-muted"
												th:text="${#strings.abbreviate(e.content, 120)}">內容前幾行預覽…</p> -->
											<small class="text-muted d-block mb-2"
												th:if="${e.tags != null}" th:text="${e.tags}">#tag</small>

											<div class="d-flex gap-2">
												<a class="btn btn-sm btn-outline-secondary"
													th:href="@{'/u/diary/' + ${e.id}}">查看</a> <a
													class="btn btn-sm btn-outline-primary"
													th:href="@{'/u/diary/' + ${e.id} + '/edit'}">編輯</a>
												<form th:action="@{'/u/diary/' + ${e.id} + '/delete'}"
													method="post" onsubmit="return confirm('確定刪除這篇日記？')">
													<input type="hidden" th:name="${_csrf?.parameterName}"
														th:value="${_csrf?.token}">
													<button class="btn btn-sm btn-outline-danger">刪除</button>
												</form>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>

						<!-- 寶寶手冊 -->
						<div th:case="'babyhandbook'">
							<div
								th:replace="~{frontend/u/baby/babyhandbook-tabs:: babyhandbookTabs(${activeTab}, ${babyhandbook})}"></div>
							
							<!-- 一次性的新增按鈕 -->
							<div class="d-flex justify-content-end mt-4">
								<a class="btn btn-success btn-sm"
									th:href="@{/blog/u/baby/babyhandbook}"> ➕ 新增寶寶手冊 </a>
							</div>
							
							<!-- ✅ 顯示多筆寶寶手冊 -->
							<div class="row row-cols-1 g-4"
								th:if="${babyhandbookList != null and #lists.size(babyhandbookList) > 0}">
								<div class="col" th:each="baby : ${babyhandbookList}">
									<div
										th:with="babyWeek=${baby.babybirthday != null ? T(java.time.temporal.ChronoUnit).WEEKS.between(baby.babybirthday.toInstant().atZone(T(java.time.ZoneId).systemDefault()).toLocalDate(), T(java.time.LocalDate).now()) : null}">
										<div
											th:replace="~{frontend/u/baby/babyhandbook :: babyhandbook(${baby}, ${babyWeek})}"></div>
									</div>
								</div>
							</div>

							<!-- ❌ 無手冊資料 -->
							<div
								th:if="${babyhandbookList == null or #lists.isEmpty(babyhandbookList)}"
								class="alert alert-info">
								目前尚未建立寶寶手冊。 <a class="btn btn-primary btn-sm ms-2"
									th:href="@{/u/baby/babyhandbook}">建立寶寶手冊</a>
							</div>

						</div>
						
						<!-- 寶寶紀錄 -->
						<div th:case="'babyrecord'">
					
							<div th:replace="~{frontend/u/baby/babyhandbook-tabs :: babyhandbookTabs(${activeTab}, ${babyhandbook})}"></div>
		        
							<div th:replace="~{frontend/u/baby/babyrecord :: babyrecord(${babyhandbook}, ${babyrecord}, ${babyWeek})}"></div>

						</div>

						<!-- 寶寶生長曲線圖 -->
						<div th:case="'baby-chart'">
							<div
								th:replace="~{frontend/u/baby/babyhandbook-tabs :: babyhandbookTabs(${activeTab}, ${babyhandbook})}"></div>
							<div
								th:replace="~{frontend/u/baby/baby-chart :: babyChart(${babyhandbook}, ${chartLabels}, ${heightChart}, ${weightChart}, ${hcChart})}"></div>
						</div>

						<!-- 待辦事項 -->
						<!-- <div th:case="'baby-todo'">
							<div
								th:replace="~{frontend/u/baby/babyhandbook-tabs :: babyhandbookTabs(${activeTab}, ${babyhandbook})}"></div>
							<div
								th:replace="~{frontend/u/baby/baby-todo :: babyTodo(${babyhandbook}, ${baby-todo})}"></div>
						</div> -->
						
						<!-- 日曆 -->
						<div th:case="'calendar'">
							<div
								th:replace="~{frontend/u/baby/calendar :: calendar(${babyhandbook})}"></div>
						</div>

						
						<!-- 預設首頁（當 activeTab 為空或未知時顯示） -->

						<div th:case="*">
							<div class="row">
								<div class="col-md-12 mb-60">
									<div
										class="single-slider-post single-slider-post--sticky text-center pb-60">
										<!-- category block 1 -->
										<div
											class="product-category-container mb-100 mb-md-90 mb-sm-90">
											<div class="container wide">
												<div class="row">
													<div class="col-lg-3 col-md-6 col-12">
														<div
															class="single-category single-category--one wow zoomIn">
															<div
																class="single-category__image single-category__image--one">
																<img src="/assets/images/category/book3.jpg"
																	class="img-fluid" alt=""
																	th:src="@{/assets/images/category/book3.jpg}">
															</div>
															<div
																class="single-category__content single-category__content--one mt-25 mb-25">
																<div class="title">
																	<p>媽媽手冊</p>
																	<a th:href="@{/blog/full-grid-left(tab='mhb')}">+
																		查看媽媽手冊</a>
																</div>
																<p class="product-count">孕程路上貼心陪伴</p>
															</div>
															<a class="banner-link"
																th:href="@{/blog/full-grid-left(tab='mhb')}"></a>
														</div>
													</div>

													<div class="col-lg-3 col-md-6 col-12">
														<div
															class="single-category single-category--one wow zoomIn">
															<div
																class="single-category__content single-category__content--one mt-25 mb-25">
																<div class="title">
																	<p>媽媽懷孕紀錄</p>
																	<a
																		th:href="@{/blog/full-grid-left(tab='mhb-records', mhbId=${mhb?.motherHandbookId})}">+
																		檢視懷孕紀錄</a>
																</div>
																<p class="product-count">每週變化一目了然</p>
															</div>
															<div
																class="single-category__image single-category__image--one">
																<img src="/assets/images/category/category-summer.jpg"
																	class="img-fluid" alt=""
																	th:src="@{/assets/images/category/category-summer.jpg}">
															</div>
															<a class="banner-link"
																th:href="@{/blog/full-grid-left(tab='mhb-records', mhbId=${mhb?.motherHandbookId})}"></a>
														</div>
													</div>

													<div class="col-lg-3 col-md-6 col-12">
														<div
															class="single-category single-category--one wow zoomIn">
															<div
																class="single-category__image single-category__image--one">
																<img src="/assets/images/category/category-women.jpg"
																	class="img-fluid" alt=""
																	th:src="@{/assets/images/category/category-women.jpg}">
															</div>
															<div
																class="single-category__content single-category__content--one mt-25 mb-25">
																<div class="title">
																	<p>身體指數紀錄圖表</p>
																	<a th:href="@{/blog/full-grid-left(tab='mhb-charts')}">+
																		查看圖表</a>
																</div>
																<p class="product-count">視覺化追蹤才安心</p>
															</div>
															<a class="banner-link"
																th:href="@{/blog/full-grid-left(tab='mhb-charts')}"></a>
														</div>
													</div>

													<div class="col-lg-3 col-md-6 col-12">
														<div
															class="single-category single-category--one wow zoomIn">
															<div
																class="single-category__content single-category__content--one mt-25 mb-25">
																<div class="title">
																	<p>待辦事項</p>
																	<a th:href="@{/blog/full-grid-left(tab='todos')}">+
																		查看待辦事項</a>
																</div>
																<p class="product-count">媽媽的行程秘書</p>
															</div>
															<div
																class="single-category__image single-category__image--one">
																<img src="/assets/images/category/category-bags.jpg"
																	class="img-fluid" alt=""
																	th:src="@{/assets/images/category/category-bags.jpg}">
															</div>
															<a class="banner-link"
																th:href="@{/blog/full-grid-left(tab='todos')}"></a>
														</div>
													</div>
												</div>
											</div>
										</div>

										<!-- end category block 1 -->

										<!-- content block -->
										<div
											class="single-slider-post__content single-slider-post--sticky__content">

											<!-- category block 2 -->
											<div
												class="product-category-container mb-100 mb-md-90 mb-sm-90">
												<div class="container wide">
													<div class="row">
														<div class="col-lg-3 col-md-6 col-12">
															<div
																class="single-category single-category--one wow zoomIn">
																<div
																	class="single-category__image single-category__image--one">
																	<img src="/assets/images/category/bluebook.jpg"
																		class="img-fluid" alt=""
																		th:src="@{/assets/images/category/bluebook.jpg}">
																</div>
																<div
																	class="single-category__content single-category__content--one mt-25 mb-25">
																	<div class="title">
																		<p>寶寶手冊</p>
																		<a th:href="@{/blog/full-grid-left-bb(tab='babyhandbook')}">+
																			查看寶寶手冊</a>
																	</div>
																	<p class="product-count">成長足跡一手掌握</p>
																</div>

																<a class="banner-link"
																	th:href="@{/blog/full-grid-left-bb(tab='babyhandbook')}"></a>
															</div>
														</div>

														<div class="col-lg-3 col-md-6 col-12">
															<div
																class="single-category single-category--one wow zoomIn">
																<div
																	class="single-category__content single-category__content--one mt-25 mb-25">
																	<div class="title">
																		<p>寶寶成長紀錄</p>
																		<a th:href="@{/u/baby/babyrecord/full-grid-left-br(tab='babyrecord', babyhandbookid=${babyhandbook?.babyhandbookid})}">+
																			查看成長紀錄</a>
																	</div>
																	<p class="product-count">紀錄寶寶每個里程碑</p>
																</div>
																<div
																	class="single-category__image single-category__image--one">
																	<img src="/assets/images/category/category-men.jpg"
																		class="img-fluid" alt=""
																		th:src="@{/assets/images/category/category-men.jpg}">
																</div>
																<a class="banner-link"
																	th:href="@{/u/baby/babyrecord/full-grid-left-br(tab='babyrecord', babyhandbookid=${babyhandbook?.babyhandbookid})}"></a>
															</div>
														</div>

														<div class="col-lg-3 col-md-6 col-12">
															<div
																class="single-category single-category--one wow zoomIn">
																<div
																	class="single-category__image single-category__image--one">
																	<img src="/assets/images/category/category-shoes.jpg"
																		class="img-fluid" alt=""
																		th:src="@{/assets/images/category/category-shoes.jpg}">
																</div>
																<div
																	class="single-category__content single-category__content--one mt-25 mb-25">
																	<div class="title">
																		<p>寶寶生長圖表</p>
																		<a th:href="@{/u/baby/baby-chart/full-grid-left-ch(tab='babychart', babyhandbookid=${babyhandbook?.babyhandbookid})}">+
																			查看圖表</a>
																	</div>
																	<p class="product-count">成長軌跡看得見</p>
																</div>
																<a class="banner-link"
																	th:href="@{/u/baby/baby-chart/full-grid-left-ch(tab='babychart', babyhandbookid=${babyhandbook?.babyhandbookid})}"></a>
															</div>
														</div>

														<div class="col-lg-3 col-md-6 col-12">
															<div
																class="single-category single-category--one wow zoomIn">
																<div
																	class="single-category__content single-category__content--one mt-25 mb-25">
																	<div class="title">
																		<p>我的日曆</p>
																		<a th:href="@{/blog/full-grid-left(tab='calendar')}">+
																			查看我的日曆</a>
																	</div>
																	<p class="product-count">育兒行程小幫手</p>
																</div>
																<div
																	class="single-category__image single-category__image--one">
																	<img src="/assets/images/category/bluememo.jpg"
																		class="img-fluid" alt=""
																		th:src="@{/assets/images/category/bluememo.jpg}">
																</div>
																<a class="banner-link"
																	th:href="@{/blog/full-grid-left(tab='calendar')}"></a>
															</div>
														</div>

													</div>
												</div>
											</div>
											<!-- end category block 2 -->

											<!-- slider block -->
											<div class="product-category-container mb-90">
												<div class="container wide">
													<div class="row">
														<div class="col-lg-12">
															<div
																class="lezada-slick-slider product-category-slider wow fadeInUp"
																data-slick-setting='{
                                 "slidesToShow": 3,
                                 "arrows": true,
                                 "autoplay": true,
                                 "autoplaySpeed": 5000,
                                 "speed": 1000,
                                 "prevArrow": {"buttonClass": "slick-prev", "iconClass": "ion-ios-arrow-thin-left" },
                                 "nextArrow": {"buttonClass": "slick-next", "iconClass": "ion-ios-arrow-thin-right" }
                               }'
																data-slick-responsive='[
                                 {"breakpoint":1501, "settings": {"slidesToShow": 3} },
                                 {"breakpoint":1199, "settings": {"slidesToShow": 3} },
                                 {"breakpoint":991, "settings": {"slidesToShow": 2, "arrows": false} },
                                 {"breakpoint":767, "settings": {"slidesToShow": 1, "arrows": false} },
                                 {"breakpoint":575, "settings": {"slidesToShow": 1, "arrows": false} },
                                 {"breakpoint":479, "settings": {"slidesToShow": 1, "arrows": false} }
                               ]'>

																<div class="col">
																	<div class="single-category single-category--two">
																		<div
																			class="single-category__image single-category__image--two">
																			<img src="/assets/images/category/sunglasses.jpg"
																				class="img-fluid" alt=""
																				th:src="@{/assets/images/category/sunglasses.jpg}">
																		</div>
																		<div
																			class="single-category__content single-category__content--two mt-25">
																			<div class="title">
																				<a th:href="@{/blog/full-grid-left(tab='calendar')}">我的日曆</a>
																			</div>
																			<p class="product-count"></p>
																		</div>
																		<a  class="banner-link"
																			th:href="@{/blog/full-grid-left(tab='calendar')}"></a>
																	</div>
																</div>

																<div class="col">
																	<div class="single-category single-category--two">
																		<div
																			class="single-category__image single-category__image--two">
																			<img src="/assets/images/category/women.jpg"
																				class="img-fluid" alt=""
																				th:src="@{/assets/images/category/women.jpg}">
																		</div>
																		<div
																			class="single-category__content single-category__content--two mt-25">
																			<div class="title">
																				<a href="/blog/full-grid-left(tab='diary')"
																					th:href="@{/blog/full-grid-left(tab='diary')}">我的日記</a>
																			</div>
																			<p class="product-count"></p>
																		</div>
																		<a href="/blog/full-grid-left(tab='diary')"
																			class="banner-link"
																			th:href="@{/blog/full-grid-left(tab='diary')}"></a>
																	</div>
																</div>

																<div class="col">
																	<div class="single-category single-category--two">
																		<div
																			class="single-category__image single-category__image--two">
																			<img src="/assets/images/category/cat-look-book.jpg"
																				class="img-fluid" alt=""
																				th:src="@{/assets/images/category/cat-look-book.jpg}">
																		</div>
																		<div
																			class="single-category__content single-category__content--two mt-25">
																			<div class="title">
																				<a href="/blog/full-grid-left(tab='album')"
																					th:href="@{/blog/full-grid-left(tab='album')}">我的相簿</a>
																			</div>
																			<p class="product-count"></p>
																		</div>
																		<a href="/blog/full-grid-left(tab='album')"
																			class="banner-link"
																			th:href="@{/blog/full-grid-left(tab='album')}"></a>
																	</div>
																</div>

																<!-- <div class="col">
																	<div class="single-category single-category--two">
																		<div
																			class="single-category__image single-category__image--two">
																			<img src="/assets/images/category/men.jpg"
																				class="img-fluid" alt=""
																				th:src="@{/assets/images/category/men.jpg}">
																		</div>
																		<div
																			class="single-category__content single-category__content--two mt-25">
																			<div class="title">
																				<a th:href="@{/blog/full-grid-left-bb(tab='notice')}">通知</a>
																			</div>
																			<p class="product-count"></p>
																		</div>
																		<a class="banner-link"
																			th:href="@{/blog/full-grid-left-bb(tab='notice')}"></a>
																	</div>
																</div> -->

																<div class="col">
																	<div class="single-category single-category--two">
																		<div
																			class="single-category__image single-category__image--two">
																			<img src="/assets/images/category/shoes.jpg"
																				class="img-fluid" alt=""
																				th:src="@{/assets/images/category/shoes.jpg}">
																		</div>
																		<div
																			class="single-category__content single-category__content--two mt-25">
																			<div class="title">
																				<a href="/sleep/quiz" th:href="@{/sleep/quiz}">睡眠健康測驗</a>
																			</div>
																			<p class="product-count"></p>
																		</div>
																		<a href="/sleep/quiz" class="banner-link"
																			th:href="@{/sleep/quiz}"></a>
																	</div>
																</div>

															</div>
															<!-- slider -->
														</div>
													</div>
												</div>
											</div>
											<!-- end slider block -->
										</div>
										<!-- end content block -->
									</div>
								</div>
							</div>
						</div>
					</div>
					<!-- end main -->
				</div>
			</div>
		</div>
		<!-- end page wrapper -->
	</section>
	<th:block th:fragment="extraJs">
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		<!-- 如果還有你的頁面圖表初始化 JS，可放這裡 -->
		<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
		<script>
(() => {
  const form = document.getElementById('mhb-delete-form');
  if (!form) return;

  // 取 CSRF（若 layout 已放）
  const csrfToken  = document.querySelector('meta[name="_csrf"]')?.content;
  const csrfHeader = document.querySelector('meta[name="_csrf_header"]')?.content;

  form.addEventListener('submit', async (e) => {
    e.preventDefault(); // 關鍵：不導頁
    if (!confirm('確定要刪除這本手冊嗎？刪除後仍可跟管理員要求復原。')) return;

    try {
      const body = new URLSearchParams(new FormData(form));
      const headers = {
        'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8',
        'X-Requested-With': 'XMLHttpRequest'
      };
      if (csrfToken && csrfHeader) headers[csrfHeader] = csrfToken;

      const res = await fetch(form.action, { method: 'POST', headers, body });
      if (!res.ok) {
        const msg = '刪除失敗（' + res.status + '）';
        alert(msg);
        return;
      }

      // 成功：留在本頁，更新 UI
      alert('已刪除');
      const btn = form.querySelector('button[type="submit"]');
      if (btn) { btn.disabled = true; btn.classList.add('disabled'); }
      // 需要的話，也可以把「編輯/檢視紀錄」按鈕停用或隱藏：
      // document.querySelectorAll('.btn-primary.btn-sm, .btn-outline-secondary.btn-sm')
      //   .forEach(el => el.classList.add('disabled'));
    } catch (err) {
      console.error(err);
      alert('刪除失敗，請稍後再試');
    }
  });
})();
</script>
	</th:block>
</body>
</html>