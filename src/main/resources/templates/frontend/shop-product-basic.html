<!DOCTYPE html>
<html class="no-js" lang="zh-Hant" xmlns:th="http://www.thymeleaf.org">

<head
	th:replace="~{frontend/layout :: head('BabyMate', ~{::extraHead})}">
<th:block th:fragment="extraHead"></th:block>
</head>

<body
	th:replace="~{frontend/layout :: layout('about', ~{::content}, ~{::extraJs}, 'footer-one')}">
	<section th:fragment="content">
		<div th:replace="~{frontend/fragments/breadcrumb :: breadcrumb('商城')}"></div>



		<!-- page wrapper -->
		<div class="shop-page-wrapper mt-100 mb-100">
			<div class="container">
				<div class="row">
					<div class="col-lg-12">

						<div class="shop-product">
							<div class="row pb-100">
								<div class="col-lg-6 mb-md-70 mb-sm-70">
									<!-- product big gallery -->
									<div class="shop-product__big-image-gallery-wrapper mb-30">
										<!-- product big gallery 右上角愛心 -->
										<div class="shop-product-rightside-icons">
											<span class="wishlist-icon"><a
												href="javascript:void(0)" class="btn-wishlist"
												th:attr="data-product-id=${product.productId},
                                                    aria-label=${favorited} ? '已加入收藏' : '加入收藏',
                                                    title=${favorited} ? '已加入收藏' : '加入收藏'"
												th:classappend="${favorited} ? ' active' : ''"> <i
													th:class="${favorited} ? 'ion-android-favorite' : 'ion-android-favorite-outline'"></i>
											</a> </span> <span class="enlarge-icon"> <a
												class="btn-zoom-popup" href="#" aria-label="放大檢視"><i
													class="ion-android-expand"></i></a>
											</span>
										</div>


										<div class="shop-product__big-image-gallery-slider">
											<div class="single-image">
												<img
													th:src="@{/product/DBGifReader(productId=${product.productId})}"
													class="img-fluid" alt="商品主圖">
											</div>
											<!-- 若有更多圖片，可複製上方 single-image 並更換 th:src -->
										</div>
									</div>
									<!-- /product big gallery -->
								</div>

								<div class="col-lg-6">
									<!-- product description -->
									<div class="shop-product__description">

										<!-- title -->
										<div class="shop-product__title mb-15">
											<h2 th:text="${product.productName}"></h2>
										</div>

										<!-- price -->
										<div class="shop-product__price mb-30">
											<span class="main-price" th:text="'NT$' + ${product.price}"></span>
										</div>

										<!-- short desc -->
										<!-- <div class="shop-product__short-desc mb-50">我是文字訊息</div> -->
										<br> <br> <br> <br>

										<!-- qty -->
										<div
											class="shop-product__block shop-product__block--quantity mb-40">
											<div class="shop-product__block__title">數量：</div>
											<div class="shop-product__block__value">
												<div class="pro-qty d-inline-block mx-0 pt-0">
													<!-- <input type="text" value="1"> -->
													<!-- 這裡加上 id 或 data-product-id，方便 JS 讀取 -->
													<input type="number" class="cart-qty" value="1" min="1"
														th:attr="data-product-id=${product.productId}">
												</div>
											</div>
										</div>

										<!-- buttons -->
										<div class="shop-product__buttons mb-40">
											<a
												class="lezada-button lezada-button--medium add-to-cart-btn"
												href="#" th:attr="data-product-id=${product.productId}">加入購物車</a>
											<!-- <a class="lezada-compare-button ml-20" href="#"
												data-tippy="Compare" data-tippy-inertia="true"
												data-tippy-animation="shift-away" data-tippy-delay="50"
												data-tippy-placement="left" data-tippy-arrow="true"
												data-tippy-theme="sharpborder"><i class="ion-ios-shuffle"></i></a> -->
										</div>
									</div>
									<!-- /product description -->
								</div>
							</div>

							<div class="row">
								<div class="col-lg-12">
									<!-- product description tabs -->
									<div class="shop-product__description-tab pt-100">
										<div
											class="tab-product-navigation tab-product-navigation--product-desc mb-50">
											<div class="nav nav-tabs justify-content-center"
												id="nav-tab2" role="tablist">
												<a class="nav-item nav-link active" id="product-tab-1"
													data-bs-toggle="tab" href="#product-series-1" role="tab"
													aria-selected="true">特色說明</a> <a class="nav-item nav-link"
													id="product-tab-2" data-bs-toggle="tab"
													href="#product-series-2" role="tab" aria-selected="false">規格說明</a>
												<a class="nav-item nav-link" id="product-tab-3"
													data-bs-toggle="tab" href="#product-series-3" role="tab"
													aria-selected="false">注意事項</a>
												<!-- <a class="nav-item nav-link" id="product-tab-4" data-bs-toggle="tab"
													href="#product-series-4" role="tab" aria-selected="false">商品評價</a> -->
											</div>
										</div>

										<div class="tab-content" id="nav-tabContent2">
											<div class="tab-pane fade show active" id="product-series-1"
												role="tabpanel" aria-labelledby="product-tab-1">
												<div class="shop-product__long-desc mb-30">
													<!-- 特色說明 -->
													<p th:text="${product.featureDesc}"></p>
												</div>
											</div>

											<div class="tab-pane fade" id="product-series-2"
												role="tabpanel" aria-labelledby="product-tab-2">
												<div class="shop-product__long-desc mb-30">
													<!-- 規格說明 -->
													<p th:text="${product.specDesc}"></p>
												</div>
											</div>

											<div class="tab-pane fade" id="product-series-3"
												role="tabpanel" aria-labelledby="product-tab-3">
												<div class="shop-product__long-desc mb-30">
													<!-- 特色說明 -->
													<p th:text="${product.note}"></p>
												</div>
											</div>

											<!-- 注意事項(目前無內容，可依需求增填) -->
											<div class="tab-pane fade" id="product-series-3"
												role="tabpanel" aria-labelledby="product-tab-3"></div>
										</div>
									</div>
									<!-- /product description tabs -->
								</div>
							</div>

						</div>
						<!-- /shop product -->
					</div>
				</div>
			</div>
		</div>
		<!-- end page wrapper -->
	</section>
	<th:block th:fragment="extraJs">
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
		<!-- 如果還有你的頁面圖表初始化 JS，可放這裡 -->
		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
		<script th:src="@{/assets/js/wishlist-toggle.js}"></script>
		<script>
			$(document)
					.ready(
							function() {
								$(".add-to-cart-btn")
										.click(
												function(e) {
													e.preventDefault(); // 阻止 <a> 預設跳轉

													const productId = $(this)
															.data("product-id");
													const qty = $(
															"input.cart-qty[data-product-id='"
																	+ productId
																	+ "']")
															.val();
													console.log(productId);
													console.log(qty);

													$
															.ajax({
																url : "/api/cart/addToCart", // 後端 Controller 會自動判斷會員或訪客
																type : "POST",
																//       contentType: "application/json",
																data : {
																	productId : productId,
																	quantity : qty
																},
																success : function() {
																	alert("已加入購物車！");
																	// 可選：刷新購物車 icon 顯示數量
																	refreshCart();
																},
																error : function(
																		xhr) {
																	alert("加入購物車失敗："
																			+ xhr.responseText);
																}
															});
												});
							});
		</script>

	</th:block>
</body>
</html>
