<!doctype html>
<html lang="zh-Hant" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{admin/layout :: head(~{::extraHead})}"></head>

<body class="sidebar-expand-lg bg-body-tertiary">
  <!-- 本頁額外 CSS -->
  <th:block th:fragment="extraHead">
    <style>
      .preview-img{max-width:160px; max-height:120px; object-fit:cover; border-radius:.25rem;}
    </style>
  </th:block>

  <!-- 用 layout 取代此容器，並把 content / extraJs 傳入 -->
  <div th:replace="~{admin/layout :: layout(content=~{::content}, extraJs=~{::extraJs})}">

    <section th:fragment="content">
      <div class="container-fluid">
        <div class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <h3 class="card-title mb-0">員工管理｜新增</h3>
            <a class="btn btn-sm btn-outline-secondary" th:href="@{/admin/staff/listAllStaff}">
              <i class="bi bi-arrow-left"></i> 回列表
            </a>
          </div>

          <div class="card-body">
            <form id="editForm" th:action="@{insert}" method="post"
		th:object="${StaffVO}" enctype="multipart/form-data" class="row g-3">
		<!--     <input type="hidden" id="userId" name="id" /> -->
		<!--     <input type="hidden" id="account" name="account"/> -->

		<div class="col-md-6">
			員工帳號: <input type="text" th:field="*{account}" pattern="[A-Za-z0-9]+"
				title="僅允許數字或英文大小寫" placeholder="請輸入員工帳號(僅允許數字或英文大小寫)" minlength=3
				maxlength=20 required class="form-control" /> <span
				th:if="${#fields.hasErrors('account')}" th:errors="account"
				class="error" id="account.errors"></span>
		</div>
		<div  class="col-md-6">
			員工暱稱: <input type="text" th:field="*{nickname}" placeholder="請輸入員工暱稱"
				minlength=3 maxlength=20 required class="form-control" /><span
				th:if="${#fields.hasErrors('nickname')}" th:errors="nickname"
				class="error" id="nickname.errors"></span>
		</div>
		<div  class="col-md-6">
			帳號密碼: <input type="password" th:field="*{password}"
				placeholder="請設定密碼" minlength=6 maxlength=20 required class="form-control" /><span
				th:if="${#fields.hasErrors('password')}" th:errors="password"
				class="error" id="password.errors"></span>
		</div>
		<div  class="col-md-6">
		角色: <select th:field="*{roleVO.roleId}" name="roleId" class="form-control" required>
				<option value="1">系統管理員</option>
				<option value="2">客服代表</option>
				<option value="3">商城管理員</option>
			</select>
		</div>
		<div  class="col-md-6">
			帳號狀態: <select th:field="*{status}" name="status" class="form-control" required>
				<option value="1">啟用</option>
				<option value="0">停用</option>
			</select>
		</div>
		<div  class="col-md-6">
			員工大頭貼: <input type="file" th:field="*{pic}" id="imageInput"
				accept="image/*" class="form-control" /><span class="error" th:utext="${errorMessage}"
				id="pic.errors"></span>
			<div id="preview-container">
				<br>
				<img id="preview" class="img-thumbnail preview-img" src="" alt="尚未選擇圖片" />
			</div>
		</div>
		<div class="col-12 d-flex gap-2">
		<button type="submit" class="btn btn-primary">儲存</button>
		<a href="/admin/staff/listAllStaff" class="btn btn-secondary">取消</a>
		</div>
	</form>
	
		<script>
		// javascript: 讀取選擇的圖片檔案並顯示於頁面
		document.getElementById('imageInput').addEventListener('change',function(event) {
			const file = event.target.files[0];
			if (!file)
				return;

			const reader = new FileReader();
			reader.readAsDataURL(file); // 讀取圖案內容
			reader.onload = function(e) {
				document.getElementById('preview').src = e.target.result;
				document.getElementById('preview').alt = "已載入圖片："+ file.name;
			};
			reader.onerror = function() {
				alert("讀取圖片時發生錯誤！");
			};
		});
	</script>
	
          </div>
        </div>
      </div>
    </section>

    <!-- 本頁不需額外 JS -->
    <th:block th:fragment="extraJs"></th:block>
  </div>
</body>
</html>
