<!doctype html>
<html lang="zh-Hant" xmlns:th="http://www.thymeleaf.org">
<!-- 讓 layout 的 <head> 接手，並把本頁的 extraHead 傳進去 -->
<head th:replace="~{admin/layout :: head(~{::extraHead})}">
  <!-- CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap4.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.bootstrap4.min.css">
</head>

<body class="sidebar-expand-lg bg-body-tertiary">
  <!-- 本頁額外 CSS（可留空） -->
  <th:block th:fragment="extraHead"></th:block>

  <!-- 用一個容器交給 layout；重點：用「命名參數」傳 content / extraJs -->
  <div th:replace="~{admin/layout :: layout(content=~{::content}, extraJs=~{::extraJs})}">

    <!-- 主要內容（只給 layout 插入，不會在這裡再渲染一次） -->
    <section th:fragment="content">
      <div class="container-fluid">
    <div class="card">
      <div class="card-header">
        <h3>使用者列表</h3>
        
        <!-- 錯誤表列 -->
		<div class="errorblock" th:utext="${errorMessage}">${errorMessage}</div><br>
        
        <a href="/staff/staffadd" class="btn btn-success mb-3">
          <i class="fas fa-plus"></i> 新增
        </a>
      </div>
      <div class="card-body">
        <table id="example1" class="table table-bordered table-hover">
<!--           <thead class="thead-dark"> -->
          <thead class="thead-light">
            <tr>
              <th>員工ID</th>
              <th>帳號</th>
              <th>暱稱</th>
              <th>角色</th>
              <th>狀態</th>
              <th>更新時間</th>
              <th>頭像</th>
              <th>修改</th>
              <th>刪除</th>
              <th>密碼變更</th>
            </tr>
          </thead>
          <tbody>
          	<th:block th:each="staffVO : ${staffListData}">
            <tr>
                <td th:text="${staffVO.staffId}"></td>
				<td th:text="${staffVO.account}"></td>
				<td th:text="${staffVO.nickname}"></td>
<!-- 				<td th:text="${staffVO.password}"></td> -->
				<td th:text="${staffVO.role}"></td>
<!-- 				<td th:text="${staffVO.status}"></td> -->
				<td th:text="${staffVO.status == 1 ? '啟用' : '停用'}"></td>
				<td th:text="${staffVO.getFormattedUpdateDate()}"></td>
<!-- 				<td th:text="${staffVO.updateDate}"></td> -->
				<td><img th:src="@{/util/DBPicReader} + '?staffId=' + ${staffVO.staffId}" width="100px"></td>
			<td>
			  <form method="post" th:action="@{/staff/staffedit}" style="margin-bottom: 0px;">
			     <input type="submit" value="修改">
			     <input type="hidden" name="staffId" th:value="${staffVO.staffId}"></form>
			</td>
			
			<td>
			  <form method="post" th:action="@{/staff/delete}" style="margin-bottom: 0px;">
			     <input type="submit" value="刪除">
			     <input type="hidden" name="staffId" th:value="${staffVO.staffId}"></form>
			</td>
			
			<td>
			  <form method="post" th:action="@{/staff/staffchangepwd}" style="margin-bottom: 0px;">
			     <input type="submit" value="密碼變更">
			     <input type="hidden" name="staffId" th:value="${staffVO.staffId}"></form>
			</td>


<!--                 <td> -->
<!--                 <a href="/staff/staffedit" class="btn btn-sm btn-primary"> -->
<!--                   <i class="fas fa-edit"></i> 修改 -->
<!--                 </a> -->
<!--                 <button class="btn btn-sm btn-danger" onclick="deleteUser(1)"> -->
<!--                   <i class="fas fa-trash"></i> 刪除 -->
<!--                 </button> -->
<!--                 </td> -->
            </tr>

            <!-- 可依需求新增更多列 -->
          </tbody>
<!--           <tfoot class="thead-dark"> -->
          <tfoot class="thead-light">
            <tr>
              <th>員工ID</th>
              <th>帳號</th>
              <th>暱稱</th>
              <th>角色</th>
              <th>狀態</th>
              <th>更新時間</th>
              <th>頭像</th>
              <th>修改</th>
              <th>刪除</th>
              <th>密碼變更</th>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
      </div>
    </section>
    
      <!-- JS 功能 -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap4.min.js"></script>
  <script src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>
  <script src="https://cdn.datatables.net/responsive/2.5.0/js/responsive.bootstrap4.min.js"></script>
  
  <script>
    $(function () {
      $('#example1').DataTable({
        responsive: true,
        lengthChange: false,
        autoWidth: false,
        buttons: ['copy', 'csv', 'excel', 'pdf', 'print', 'colvis'],
        ordering: true,
        searching: true,
        paging: true,
        info: true
      }).buttons().container().appendTo('#example1_wrapper .col-md-6:eq(0)');
    });

    function deleteUser(id) {
      if (confirm('確定要刪除 ID 為 ' + id + ' 的使用者嗎？')) {
        alert('已刪除使用者 ID: ' + id);
        // 你可以在這裡呼叫 API 後端刪除再重新載入畫面
      }
    }
  </script>
  <!-- Font Awesome for icons -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    

    <!-- 本頁額外 JS（可留空） -->
    <th:block th:fragment="extraJs"></th:block>
  </div>
</body>
</html>
